var v;async function X(){if(v)return;let t=(await(await fetch("/cmudict.dict")).text()).split(/\r\n|\r|\n/g);v={};let a=0;for(;a<t.length;){let r=t[a];if(r[0]!==";"){let i=r.slice(0,r.indexOf(" "));v[i]=r.slice(i.length+1)}a+=1}}async function $(e){return await X(),(v[e.toLowerCase().trim()]??"").toLowerCase().replace(/\W/g,"'")}var k={"short-carrier":"telco","i-tengwa":"telco","long-carrier":"aara",0:"zero",1:"one",2:"two",3:"three",4:"four",5:"five",6:"six",7:"seven",8:"eight",9:"nine",10:"ten",11:"eleven",comma:"pusta","full-stop":"double-pusta",colon:"triple-pusta",a:"triple-dot-above",e:"acute",i:"dot-above",o:"right-curl",u:"left-curl",y:"double-dot-below","double-dot":"double-dot-above","reversed-triple-dot":"reversed-triple-dot-above",chevron:"breve","double-e":"double-acute","double-o":"double-right-curl","double-u":"double-left-curl","curl-below":"right-curl-below","accent-below":"left-curl-below","stemless-anna":"osse",luva:"osse","a-tengwa":"osse",andaith:"acute",circumflex:"yanta-above",aha:"harma","tinco-extended":"extended-tinco","parma-extended":"extended-parma","calma-extended":"extended-calma","quesse-extended":"extended-quesse","ando-extended":"extended-ando","umbar-extended":"extended-umbar","anga-extended":"extended-anga","ungwe-extended":"extended-ungwe","extended-thuule":"extended-tinco","extended-formen":"extended-parma","extended-harma":"extended-calma","extended-hwesta":"extended-quesse","extended-anto":"extended-ando","extended-ampa":"extended-umbar","extended-anca":"extended-anga","extended-unque":"extended-ungwe","carrier-below":"thinnas",amaticse:"dot-above",nuntisce:"dot-below","u-curl":"over-twist",amatwe:"bar-above",tilde:"tilde-above","open-dot-below":"ring-below","x-curl":"right-curl-below","sa-rince":"hook","left-following-silme":"hook","down-following-silme":"left-curl-below","swash-curl":"hook-looped-left","lowered-swash-curl":"low-swash-hook","swash-hook":"hook-looped-left","upward-curl":"upward-hook","lifted-curl":"lifted-hook",suule:"thuule","round-carrier":"uure",of:"of-shorthand",the:"the-shorthand",ofthe:"of-the-shorthand",and:"and-shorthand",at:"at-shorthand",degree:"degree-mark","semi-colon":"wide-dash","end-paragraph":"quadruple-pusta"},g={placeholder:"tengwa",alda:"tengwa",pusta:"tengwa","double-pusta":"tengwa","triple-pusta":"tengwa","quadruple-pusta":"tengwa","quintuple-pusta":"tengwa","exclamation-mark":"tengwa","question-mark":"tengwa","section-mark":"tengwa","double-section-mark":"tengwa","quotation-mark":"tengwa","roman-question-mark":"tengwa","roman-exclamation-mark":"tengwa","roman-period":"tengwa","roman-comma":"tengwa","roman-semicolon":"tengwa",two:"tengwa",three:"tengwa",four:"tengwa",five:"tengwa",six:"tengwa",seven:"tengwa",eight:"tengwa",nine:"tengwa",ten:"tengwa",eleven:"tengwa","roman-open-quote":"tengwa","roman-close-quote":"tengwa","roman-open-paren":"tengwa","roman-close-paren":"tengwa","number-sign":"tengwa","dollar-sign":"tengwa","percent-sign":"tengwa","and-shorthand":"tengwa","left-parenthesis":"tengwa","right-parenthesis":"tengwa",asterisk:"tengwa","double-dash":"tengwa","plus-sign":"tengwa","equal-sign":"tengwa",solidus:"tengwa","less-than-sign":"tengwa","greater-than-sign":"tengwa","at-shorthand":"tengwa","degree-mark":"tengwa","inverted-exclamation-mark":"tengwa","inverted-question-mark":"tengwa","left-pointing-double-angle-quotation-mark":"tengwa","right-pointing-double-angle-quotation-mark":"tengwa","horizontal-ellipsis":"tengwa",dash:"tengwa","wide-dash":"tengwa","of-shorthand":"tengwa","the-shorthand":"tengwa","of-the-shorthand":"tengwa",hwesta:"tengwa",tinco:"tengwa",parma:"tengwa",calma:"tengwa",quesse:"tengwa",oore:"tengwa",vala:"tengwa",anna:"tengwa","open-anna":"tengwa",vilya:"tengwa",zero:"tengwa",one:"tengwa","anna-sindarinwa":"tengwa","stemless-vala":"tengwa",roomen:"tengwa",arda:"tengwa",yanta:"tengwa",harma:"tengwa",ando:"wide-tengwa",umbar:"wide-tengwa",anga:"wide-tengwa",ungwe:"wide-tengwa",anto:"wide-tengwa",ampa:"wide-tengwa",anca:"wide-tengwa",unque:"wide-tengwa",nuumen:"wide-tengwa",malta:"wide-tengwa","malta-with-curl":"wide-tengwa",noldo:"wide-tengwa",nwalme:"wide-tengwa",lambe:"wide-tengwa","turned-lambe":"wide-tengwa","hwesta-sindarinwa":"wide-tengwa",silme:"wide-tengwa","alt-silme":"wide-tengwa",thuule:"extended-tengwa",formen:"extended-tengwa",uure:"extended-tengwa","silme-nuquerna":"extended-tengwa","alt-silme-nuquerna":"extended-tengwa",esse:"extended-tengwa","alt-esse":"extended-tengwa","esse-nuquerna":"extended-tengwa","alt-esse-nuquerna":"extended-tengwa","extended-tinco":"extended-tengwa","extended-parma":"extended-tengwa","extended-calma":"extended-tengwa","extended-quesse":"extended-tengwa","extended-ando":"extended-tengwa","extended-umbar":"extended-tengwa","extended-anga":"extended-tengwa","extended-ungwe":"extended-tengwa",osse:"narrow-tengwa",telco:"narrow-tengwa",aara:"narrow-tengwa",halla:"narrow-tengwa",hyarmen:"narrow-tengwa","triple-dot-below":"below","reversed-triple-dot-below":"below","triple-dot-above":"above","reversed-triple-dot-above":"above",acute:"above","acute-below":"below","dot-above":"above","right-curl":"above","left-curl":"above","double-right-curl":"above","double-acute":"above","double-left-curl":"above","over-twist":"above",breve:"above","yanta-above":"above","bar-above":"above","bar-below":"below","tilde-above":"above","double-dot-above":"above",grave:"above","dot-below":"below","dot-below-after":"below","left-curl-below":"diacritic-hook","right-curl-below":"diacritic-hook",hook:"hook","hook-looped-left":"hook","hook-looped-right":"hook","low-swash-hook":"hook","upward-hook":"hook","lifted-hook":"hook","bar-inside":"other","dot-inside":"other","duodecimal-lsd-mark":"below","ring-below":"below","double-dot-below":"below","double-dot-inside":"other","double-acute-below":"below","tilde-below":"other","tilde-high":"above","tilde-low":"below","left-hook-below":"below","right-hook-below":"below",thinnas:"below"},I={"wide-tengwa":0,tengwa:1,"extended-tengwa":2,"narrow-tengwa":3},M=["thinnas","bar-above","bar-below","tilde-high","tilde-below","tilde-above","over-twist","right-curl-below","dot-below","acute","double-dot-above","double-dot-below","dot-above","right-curl","left-curl","left-curl-below","double-right-curl","double-acute","double-left-curl","breve","yanta-above","double-dot-above","grave","triple-dot-above","reversed-triple-dot-above","triple-dot-below","reversed-triple-dot-below","hook-looped-left","hook-looped-right","bar-inside","dot-inside","double-dot-inside"];function c(e){let n=g[e];return n==="above"||n==="below"||n==="inside"||n==="diacritic-hook"||n==="other"}function O(e){let n=0;for(let t of e)g[t]==="above"&&(n+=1);return n}function L(e){let n=e.slice(1,-1);return g[n]==="above"}function R(e){let n=e.slice(1,-1);return g[n]==="below"||g[n]==="diacritic-hook"}function T(e){return["triple-dot-above","reversed-triple-dot-above","acute","double-acute","dot-above","double-dot-above","right-curl","double-right-curl","left-curl","double-left-curl"].includes(e)}function p(e){let n="";if(e[0]==="{")n="}";else if(e[0]==="[")n="]";else return["",e[0],e.substring(1)];let t=1;for(;e[t]!==n;)if(e[t++]===void 0)return["","",""];let a=e.substring(1,t),r=a.toLowerCase();return k[r]&&(a===r?a=k[r]:a=k[r].toUpperCase()),g[a.toLowerCase()]?[a,"",e.substring(t+1)]:a.length>0?["",n==="]"?`[${a}]`:`{${a}}`,e.substring(t+1)]:["",e[0],e.substring(t+1)]}function f(e){return e.length===0?"":e.length===1?`[${e[0]}]`:(e.sort((n,t)=>M.indexOf(t)-M.indexOf(n)),e.map(n=>`[${n}]`).join(""))}function b(e,n){return n.length===0?e?`{${e}}`:"":`{${e||"telco"}}`+f(n)}var x={placeholder:"\u25CC",tinco:"\uE000",parma:"\uE001",calma:"\uE002",quesse:"\uE003",ando:"\uE004",umbar:"\uE005",anga:"\uE006",ungwe:"\uE007",thuule:"\uE008",formen:"\uE009",harma:"\uE00A",hwesta:"\uE00B",anto:"\uE00C",ampa:"\uE00D",anca:"\uE00E",unque:"\uE00F",nuumen:"\uE010",malta:"\uE011",noldo:"\uE012",nwalme:"\uE013",oore:"\uE014",vala:"\uE015","stemless-vala":"\uE031",anna:"\uE016",vilya:"\uE017",osse:"\uE032","extended-tinco":"\uE018","extended-parma":"\uE019","extended-calma":"\uE01A","extended-quesse":"\uE01B","extended-ando":"\uE01C","extended-umbar":"\uE01D","extended-anga":"\uE01E","extended-ungwe":"\uE01F",roomen:"\uE020",arda:"\uE021",lambe:"\uE022",alda:"\uE023",silme:"\uE024","alt-silme":"\uE024","silme-nuquerna":"\uE025","alt-silme-nuquerna":"\uE025",esse:"\uE026","alt-esse":"\uE026","esse-nuquerna":"\uE027","alt-esse-nuquerna":"\uE027",hyarmen:"\uE028","hwesta-sindarinwa":"\uE029",yanta:"\uE02A",uure:"\uE02B",aara:"\uE02C",halla:"\uE02D",telco:"\uE02E","turned-lambe":"\uE031","anna-sindarinwa":"\uE035","open-anna":"\uE036","malta-with-curl":"\uE03A","reversed-triple-dot-above":"\uE056","reversed-triple-dot-below":"\uE041","triple-dot-above":"\uE040","dot-above":"\uE044","right-curl":"\uE04A","left-curl":"\uE04C","over-twist":"\uE052",breve:"\uE053","double-right-curl":"\uE04A\uE04A","double-acute":"\uE046\uE046","double-left-curl":"\uE04C\uE04C",acute:"\uE046","acute-below":"\uE047","right-hook-below":"\uE04B","upward-hook":"\uE058","lifted-hook":"\uE058","hook-looped-left":"\uE058","hook-looped-right":"\uE058",grave:"\uE054","dot-below":"\uE045","dot-below-after":"\uE045","dot-inside":"\uE05A","double-dot-above":"\uE042","double-dot-inside":"\uE043","double-dot-below":"\uE043","triple-dot-below":"\uE041","double-acute-below":"\uE049","bar-above":"\uE050","bar-below":"\uE051","bar-inside":"\uE051","tilde-above":"\uE050","tilde-below":"\uE051","tilde-high":"\uE050","tilde-low":"\uE051","right-curl-below":"\uE04B","left-curl-below":"\uE04D","yanta-above":"\uE055",zero:"\uE070",one:"\uE071",two:"\uE072",three:"\uE073",four:"\uE074",five:"\uE075",six:"\uE076",seven:"\uE077",eight:"\uE078",nine:"\uE079",ten:"\uE07A",eleven:"\uE07B","ring-below":"\uE07D",hook:"\uE058","left-hook-below":"\uE059","low-swash-hook":"\uE058",thinnas:"\uE057","of-shorthand":"\uE01D","of-the-shorthand":"\uE01D\uE051","the-shorthand":"\uE01C","and-shorthand":"\uE004\uE045\uE050","exclamation-mark":"\uE065","quotation-mark":'"',"number-sign":"#","dollar-sign":"$","percent-sign":"%","left-parenthesis":"\uE067","right-parenthesis":"\uE067",asterisk:"*","plus-sign":"+","equal-sign":"=","degree-mark":"\xB0","roman-question-mark":"?","roman-exclamation-mark":"!","roman-period":".","roman-comma":",","roman-semicolon":";","roman-open-quote":"\u2018","roman-close-quote":"\u2019","roman-open-paren":"(","roman-close-paren":")",pusta:"\uE060","double-pusta":"\uE061","triple-pusta":"\uE062","quadruple-pusta":"\uE063","quintuple-pusta":"\uE064","section-mark":"\uE068","double-section-mark":"\uE069",dash:"\uE068","wide-dash":"\uE069","double-dash":"\uE069",solidus:"/","duodecimal-lsd-mark":"\uE07D","less-than-sign":"<","greater-than-sign":">","question-mark":"\uE066","at-shorthand":"\uE000\uE040","inverted-exclamation-mark":"\uE06C","inverted-question-mark":"\uE066","left-pointing-double-angle-quotation-mark":"\xAB","right-pointing-double-angle-quotation-mark":"\xBB","horizontal-ellipsis":"\u2026"},W={...x,"hook-looped-left":"\uE058\uE058","hook-looped-right":"\uE058\uE058"},D={...x,TINCO:"\uE080",PARMA:"\uE081",CALMA:"\uE082",QUESSE:"\uE083",ANDO:"\uE084",UMBAR:"\uE085",ANGA:"\uE086",UNGWE:"\uE087",THUULE:"\uE088",FORMEN:"\uE089",HARMA:"\uE08A",HWESTA:"\uE08B",ANTO:"\uE08C",AMPA:"\uE08D",ANCA:"\uE08E",UNQUE:"\uE08F",NUUMEN:"\uE090",MALTA:"\uE091",NOLDO:"\uE092",NWALME:"\uE093",OORE:"\uE094",VALA:"\uE095",ANNA:"\uE096",VILYA:"\uE097",OSSE:"\uE0B2","EXTENDED-TINCO":"\uE098","EXTENDED-PARMA":"\uE099","EXTENDED-CALMA":"\uE09A","EXTENDED-QUESSE":"\uE09B","EXTENDED-ANDO":"\uE09C","EXTENDED-UMBAR":"\uE09D","EXTENDED-ANGA":"\uE09E","EXTENDED-UNGWE":"\uE09F",ROOMEN:"\uE0A0",ARDA:"\uE0A1",LAMBE:"\uE0A2",ALDA:"\uE0A3",SILME:"\uE0A4","ALT-SILME":"\uE0A4","SILME-NUQUERNA":"\uE0A5","ALT-SILME-NUQUERNA":"\uE0A5",ESSE:"\uE0A6","ALT-ESSE":"\uE0A6","ESSE-NUQUERNA":"\uE0A7","ALT-ESSE-NUQUERNA":"\uE0A7",HYARMEN:"\uE0A8",YANTA:"\uE0AA",HALLA:"\uE0AD",TELCO:"\uE0AE",AARA:"\uE0AC"};async function Z(e){try{let n={ok:true,text:async()=>await Bun.file(e).text()};if(n.ok){let t=await n.text();return JSON.parse(J(t))}else return{warnings:[`The mode file could not be loaded (${await n.text()})`]}}catch(n){return n instanceof TypeError?n.message==="Failed to fetch"?{warnings:[`The mode file <b>"${e}"</b> could not be loaded`]}:{warnings:[n.message]}:{warnings:[n.toString()]}}}var C=new Map;async function A(e){if(e!=="erebor")return C.has(e)||C.set(e,Z(`${import.meta.dir}/modes/${e}.jsonc`)),C.get(e)}function J(e){let n="",t=[];for(let a=0;a<e.length;a++){let r=e[a],i=e[a+1];switch(n){case"string":r==="\\"&&i==='"'?(t.push('\\"'),a+=1):(r==='"'&&(n=""),t.push(r));break;case"block-comment":r==="*"&&i==="/"&&(n="",a+=1);break;case"line-comment":r===`
`&&(n="");break;default:r==='"'?(n="string",t.push(r)):r==="/"?i==="/"?(n="line-comment",a+=1):i==="*"?(n="block-comment",a+=1):t.push(r):t.push(r)}}return t.join("")}function K(e,{isDuodecimal:n=!0}){let t="",a=parseInt(e,10);if(!Number.isFinite(a))return"";let r=0;for(;e[r]==="0";)r+=1;if(n){for(t=a.toString(12),t=t.split("").reverse().join("");r>1;)t+="0",r-=1;return t.length>1&&(t=t[0]+"\u2022"+t.substring(1)),t=t.replace(/0/g,"{zero}"),t=t.replace(/1/g,"{one}"),t=t.replace(/2/g,"{two}"),t=t.replace(/3/g,"{three}"),t=t.replace(/4/g,"{four}"),t=t.replace(/5/g,"{five}"),t=t.replace(/6/g,"{six}"),t=t.replace(/7/g,"{seven}"),t=t.replace(/8/g,"{eight}"),t=t.replace(/9/g,"{nine}"),t=t.replace(/a/g,"{ten}"),t=t.replace(/b/g,"{eleven}"),t.replace(/•/g,"[ring-below]")}for(t=e.split("").reverse().join("");r>1;)t+="0",r-=1;return t.length>1&&(t=t[0]+"\u2022"+t.substring(1)),t=t.replace(/0/g,"{zero}[dot-above]"),t=t.replace(/1/g,"{one}[dot-above]"),t=t.replace(/2/g,"{two}[dot-above]"),t=t.replace(/3/g,"{three}[dot-above]"),t=t.replace(/4/g,"{four}[dot-above]"),t=t.replace(/5/g,"{five}[dot-above]"),t=t.replace(/6/g,"{six}[dot-above]"),t=t.replace(/7/g,"{seven}[dot-above]"),t=t.replace(/8/g,"{eight}[dot-above]"),t=t.replace(/9/g,"{nine}[dot-above]"),t.replace(/•/g,"[ring-below]")}function y(e,{isDuodecimal:n=!0}){let t=e.match(/^[0-9]+/);return[K(t[0],{isDuodecimal:n}),e.substring(t[0].length)]}function ee(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function E(e){if(e.length===1){if(/^[aeiouy]$/.test(e))return 0;if(/^[\xE2\xEA\xEE\xF4\xFB]$/.test(e))return 1}return-1}function U(e){let n=[],t="",a="";for(let r of e)t==="{"?r==="}"&&(n.push(a),a="",t=""):t==="["?r==="]"&&(n.push(a),a="",t=""):r==="{"?(a&&n.push(a),a="",t="{"):r==="["&&(a&&n.push(a),a="",t="["),a+=r;return a&&n.push(a),n}function B(e,n){if(n.normalizeVowels&&(e=U(e).map(t=>(t.startsWith("{")||t.startsWith("[")||(t=t.replace(/ā|á|aa/g,"\xE2"),t=t.replace(/ē|é|ee/g,"\xEA"),t=t.replace(/ī|í|ii/g,"\xEE"),t=t.replace(/ō|ó|oo/g,"\xF4"),t=t.replace(/ū|ú|uu/g,"\xFB"),t=t.replace(/ȳ|ý|yy/g,"\u0177"),t=t.replace(/ä/g,"a"),t=t.replace(/ë/g,"e"),t=t.replace(/ï/g,"i"),t=t.replace(/ö/g,"o"),t=t.replace(/ü/g,"u"),t=t.replace(/ÿ/g,"y"),t=t.replace(/Ā|Á|AA/g,"\xC2"),t=t.replace(/Ē|É|EE/g,"\xCA"),t=t.replace(/Ī|Í|II/g,"\xCE"),t=t.replace(/Ō|Ó|OO/g,"\xD4"),t=t.replace(/Ū|Ú|UU/g,"\xDB"),t=t.replace(/Ȳ|Ý|YY/g,"\u0176"),t=t.replace(/Ä/g,"A"),t=t.replace(/Ë/g,"E"),t=t.replace(/Ï/g,"I"),t=t.replace(/Ö/g,"O"),t=t.replace(/Ü/g,"U"),t=t.replace(/Ÿ/g,"Y")),t)).join("")),n.preprocess){if(!n._preprocessRE){n._preprocessRE={};for(let t in n.preprocess)if(t.startsWith("/")){let a=t.lastIndexOf("/"),r=t.substring(1,a),i=t.substring(a+1);n._preprocessRE[t]=new RegExp(r,i||"g")}else n._preprocessRE[t]=new RegExp(ee(t),"g")}for(let t in n.preprocess)e=U(e).map(a=>a.startsWith("{")||a.startsWith("[")?a:a.replace(n._preprocessRE[t],n.preprocess[t])).join("")}return e}async function P(e,n){let t=n.toLowerCase(),a=e.words?.[t]?await m(e.words[t],e):await S(t,e);if(/^[A-ZÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞ߃ŠŽČ]/.test(n)){let r=a.match(/^({[a-zàáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿšžč\-]+})(.*)/);r&&(a=r[1].toUpperCase()+r[2])}return a}var F="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u017F*+~#",h={"!":"{exclamation-mark}",'"':"{quotation-mark}","\u201E":"{quotation-mark}","\u301D":"{quotation-mark}","\u301E":"{quotation-mark}","\u301F":"{quotation-mark}","#":"{number-sign}",$:"{dollar-sign}","%":"{percent-sign}","&":"{and-shorthand}","(":"{left-parenthesis}",")":"{right-parenthesis}","*":"{asterisk}","\u2022":"{asterisk}","+":"{plus-sign}",",":"\xA0{pusta}","-":"{dash}",".":"\xA0{double-pusta}","..":"{end-paragraph}","/":"{solidus}",":":"\xA0{triple-pusta}",";":"{wide-dash}","<":"{less-than-sign}","=":"{equal-sign}",">":"{greater-than-sign}","?":"{question-mark}","@":"{at}","\xB0":"{degree-mark}","\xA1":"{inverted-exclamation-mark}","\xBF":"{inverted-question-mark}","\xAB":"{left-pointing-double-angle-quotation-mark}","\xBB":"{right-pointing-double-angle-quotation-mark}",\u00DE:"{THUULE}",\u00FE:"{thuule}",\u00F0:"{anto}",\u00D0:"{ANTO}","~":"{double-dash}","\u2010":"{double-dash}","\u2012":"{double-dash}","\u2013":"{double-dash}","\u2014":"{double-dash}","\u2026":"{horizontal-ellipsis}","\xB6":"{end-paragraph}",0:"{zero}",1:"{one}",2:"{two}",3:"{three}",4:"{four}",5:"{five}",6:"{six}",7:"{seven}",8:"{eight}",9:"{nine}",a:"[triple-dot-above]",e:"[acute]",i:"[dot-above]",o:"[right-curl]",u:"[left-curl]",y:"[breve]","+-":"[bar-above]","+_":"[bar-below]","+i":"[dot-above]","+ii":"[double-dot-above]","+e":"[acute]","+ee":"[double-acute]","+u":"[right-curl]","+uu":"[double-right-curl]","+o":"[left-curl]","+oo":"[double-left-curl]","+a":"[triple-dot-above]","+a*":"[reversed-triple-dot-above]","t*":"{thuule}","t#":"{tinco-extended}","d#":"{ando-extended}","p#":"{parma-extended}","b#":"{umbar-extended}","c#":"{calma-extended}","j#":"{anga-extended}","g#":"{ungwe-extended}","k#":"{quesse-extended}","c*":"{harma}","j*":"{anca}","k*":"{hwesta}","g*":"{unque}"};h['"']="{quotation-mark}";h['"']="{quotation-mark}";function _(e,n){if(e==="left-curl"&&n.includes("left-curl"))return n.splice(n.indexOf("left-curl"),1),n.push("double-left-curl"),!0;if(e==="right-curl"&&n.includes("right-curl"))return n.splice(n.indexOf("right-curl"),1),n.push("double-right-curl"),!0;if(e==="acute"&&n.includes("acute"))return n.splice(n.indexOf("acute"),1),n.push("double-acute"),!0;if(e==="dot-above"&&n.includes("dot-above"))return n.splice(n.indexOf("dot-above"),1),n.push("double-dot-above"),!0;if(T(e)){for(let t of n)if(T(t))return!1}return n.push(e),!0}function z(e,n){let t="",a=[],r="";if(n){for(;e;){let o;[o,r,e]=p(e),o?c(o)?_(o,a)||(t+=b("telco",a),a=[o]):(t+=`{${o}}${f(a)}`,a=[]):(a.length>0&&(t+=`{telco}${f(a)}`,a=[]),r?t+=r:e=e.substring(1))}return a.length===0?t:a.length===1&&a[0]==="dot-below"?t+"[dot-below]":t.endsWith("{telco}")?`${t}${f(a)}`:`${t}{telco}${f(a)}`}let i="";for(;e;){let o;[o,r,e]=p(e),o?c(o)?_(o,a)||(t+=b(i,a),a=[o],i=""):(t+=b(i,a),i=o,a=[]):(t+=b(i,a)+r,i="",a=[],e=e.substring(1))}return t+b(i,a)}function V(e){let n=[];return e==null&&n.push("Input cannot be null or undefined"),typeof e!="string"&&n.push("Input must be a string"),e.length>1e4&&n.push("Input is too long (maximum 10,000 characters)"),{isValid:n.length===0,errors:n}}function j(e){let n=[];if(!e)return n.push("Mode is required for transcription"),{isValid:!1,errors:n};if((!e.name||typeof e.name!="string")&&n.push("Mode must have a valid name"),e.map&&typeof e.map!="object"&&n.push("Mode map must be an object"),e.preprocess)if(typeof e.preprocess!="object")n.push("Mode preprocess must be an object");else for(let[t,a]of Object.entries(e.preprocess))typeof t!="string"&&n.push(`Preprocess key must be string, got ${typeof t}`),typeof a!="string"&&n.push(`Preprocess value for "${t}" must be string, got ${typeof a}`);return e.wordPattern&&typeof e.wordPattern!="string"&&n.push("Mode wordPattern must be a string"),{isValid:n.length===0,errors:n}}async function m(e,n){if(!V(e).isValid||!j(n).isValid||!n?.name)return"";let r="",i=n.wordPattern??F,o=new RegExp(`^[${i}]+`),l=new RegExp(`\\[[a-zA-Z-]+\\]|\\{[a-zA-Z-]+\\}|\\#[0-9]+|[${i}]+|[^${i}\\[\\]\\{\\}]+`,"g"),s=e.match(l);if(s){e="";for(let u of s)o.test(u)?e+=B(u,n):e+=u}for(;e;)if(e[0]==="\xB7")r+=" ",e=e.substring(1);else if(e[0]==="-"&&e[1]==="-")r+="{double-dash}",e=e.substring(2);else if(e[0]==="-"&&n.suppressIntrawordDash)e=e.substring(1);else if(/^of the[^a-z]/i.test(e)&&n.words["of the"])r+=n.words["of the"],e=e.substring(6);else if(/^[0-9]/.test(e)){let u=e.match(/^[0-9]+[a-zA-Z]+/);if(u&&n.words?.[u[0]])r+=n.words[u[0]],e=e.substring(u[0].length);else{let d;[d,e]=y(e,{isDuodecimal:!0}),r+=d}}else if(/^#[0-9]/.test(e)){let u;[u,e]=y(e.substring(1),{isDuodecimal:!1}),r+=u}else if(o.test(e)){let u=e.match(o)[0];e=e.substring(u.length),r+=await P(n,u)}else if(e[0]==="{"||e[0]==="["){let u="",d="";[u,d,e]=p(e),u?c(u)?r+=`[${u}]`:r+=`{${u}}`:d?r+=d:e=e.substring(1)}else e[0]==="'"&&!n.preprocess?.["'"]||(r+=h[e[0]]??e[0]),e=e.substring(1);return r}async function S(e,n){if(n.name==="english-phonemic"){let r=await $(e);if(!r)return await m(e,await A("english"));e=r}let t="",a="";e=`^${e}$$$$$$$`;for(let r=0;r<e.length-7;r++){a=w(e.substring(r,r+7),e[r+7],n),a?r+=6:(a=w(e.substring(r,r+6),e[r+6],n),a?r+=5:(a=w(e.substring(r,r+5),e[r+5],n),a?r+=4:(a=w(e.substring(r,r+4),e[r+4],n),a?r+=3:(a=w(e.substring(r,r+3),e[r+3],n),a?r+=2:(a=w(e.substring(r,r+2),e[r+2],n),a?r+=1:a=w(e[r],e[r+1],n))))));let i=t.lastIndexOf("{"),o=i>=0?t.slice(i,t.lastIndexOf("}")+1):"";if(n.tehtarFollow&&R(a)){let l=t.lastIndexOf("}"),s=t.slice(l+1),[u,,d]=p(s);u&&c(u)?l<0?t="{telco}["+u+"]"+d+a:o==="{telco}"?t=t.slice(0,l)+"}["+u+"]"+d+a:t=t.slice(0,l)+"}{telco}["+u+"]"+d+a:(o==="{lambe}"&&(a==="[dot-below]"?a="[dot-inside]":a==="[bar-below]"&&(a="[bar-inside]")),i>=0?t=t.slice(0,i)+a+t.slice(i):t+=a)}else a!=="[]"&&(!n.tehtarFollow&&L(a)&&o===""&&(t+="{telco}"),t+=a)}return z(t,n.tehtarFollow)}function w(e,n,t){if(!t||e==="'"&&!t.preprocess?.["'"])return"";let a="";if(e==="r"&&t.rrule)return E(n)>=0?"{roomen}":"{oore}";if(a=t.map[e]??h[e]??"",a.startsWith("{}")){if(a=a.slice(2),!(t.map[n]??h[n])){let r=E(n);r===0?a+="{telco}":r===1&&(a+="{aara}")}}else if(a.endsWith("{}")&&(a=a.slice(0,-2),!(t.map[n]??h[n]))){let r=E(n);r===0?a+="{telco}":r===1&&(a+="{aara}")}return a}var q={placeholder:"\u25CC",tinco:"1",parma:"q",calma:"a",quesse:"z",ando:"2",umbar:"w",anga:"s",ungwe:"x",thuule:"3",formen:"e",harma:"d",hwesta:"c",anto:"4",ampa:"r",anca:"f",unque:"v",nuumen:"5",malta:"t",noldo:"g",nwalme:"b",oore:"6",vala:"y","stemless-vala":"\xBE",anna:"h","anna-sindarinwa":"h","open-anna":"h",vilya:"n",osse:"]",roomen:"7",arda:"u",lambe:"j","turned-lambe":"j",alda:"m",silme:"8","alt-silme":"8","silme-nuquerna":"i","alt-silme-nuquerna":"I",esse:"k","alt-esse":"k","esse-nuquerna":",","alt-esse-nuquerna":"<",hyarmen:"9","hwesta-sindarinwa":"o",yanta:"l",uure:".","malta-with-curl":"t\xA1",halla:"\xBD",telco:"`",aara:"~","extended-tinco":"!","extended-parma":"Q","extended-calma":"A","extended-quesse":"Z","extended-ando":"@","extended-umbar":"W","extended-anga":"S","extended-ungwe":"X",zero:"\xF0",one:"\xF1",two:"\xF2",three:"\xF3",four:"\xF4",five:"\xF5",six:"\xF6",seven:"\xF7",eight:"\xF8",nine:"\xF9",ten:"\xFA",eleven:"\xFB","ring-below":["\xA9","\xA8","\xA8","\xA8"],"reversed-triple-dot-above":["\xAA","\xAF","\xB5","\xB5"],"reversed-triple-dot-below":["\xD0","\xD1","\xD2","\xD3"],"triple-dot-above":["#","E","D","C"],acute:["$","R","F","V"],"right-curl":["^","Y","H","N"],"left-curl":["&","U","J","M"],"double-right-curl":"NY","double-acute":"VR","double-left-curl":"MU",grave:"\u201E","of-the-shorthand":'W"',"of-shorthand":"W","the-shorthand":"@","and-shorthand":"2\xC8P","dot-below":["\xC8","\xC9","\xCA","\xCB"],"dot-below-after":["\xC8","\xC9","\xCA","\xCB"],"dot-above":["%","T","G","B"],thinnas:["\xFC","\xFD","\xFE","\xFF"],hook:"+","right-hook-below":["|","}"],"left-hook-below":"_","hook-looped-left":"\xA3","hook-looped-right":"\xA3","low-swash-hook":"\xA5","upward-hook":"\xC5","lifted-hook":"\xA1","over-twist":["\xE8","\xE9","\xEA","\xEB"],breve:["\xD8","\xD9","\xDA","\xDB"],"yanta-above":["\xDC","\xDD","\xDE","\xDF"],"tilde-above":["P","p"],"tilde-below":[":",";"],"tilde-high":[")","0"],"tilde-low":["?","/"],"right-curl-below":["\xE4","\xE5","\xE6","\xE7"],"acute-below":["\x89","\x8A","\x8B","\x9F"],"dot-inside":"L","bar-inside":"\xB8","bar-above":["{","[","[","["],"bar-below":['"',"'"],"double-dot-above":["\xD4","\xD5","\xD6","\xD7"],"double-dot-inside":"\xB4","double-dot-below":["\xCC","\xCD","\xCE","\xCF"],"triple-dot-below":["\xD0","\xD1","\xD2","\xD3"],"double-acute-below":["\x83","\x83","\x85","\x86"],"exclamation-mark":"\xC1","quotation-mark":"\u203A","number-sign":"5{","dollar-sign":"i[","percent-sign":"q6R85$1","left-parenthesis":"\u203A","right-parenthesis":"\u203A",asterisk:"=\u02C6=","plus-sign":'2"#',"degree-mark":"=","roman-question-mark":"\xAE","roman-exclamation-mark":"\xC7","roman-period":"\xBA","roman-comma":"\xA9","roman-semicolon":"\xC3","roman-open-quote":"\xB1","roman-close-quote":"\xB2","roman-open-paren":"\x8C","roman-close-paren":"\x9C",pusta:"=",dash:"\\","wide-dash":"\xC2","double-dash":"\xAC","double-pusta":"-",solidus:"-","triple-pusta":"\u02C6","less-than-sign":"\\","greater-than-sign":"\\","question-mark":"\xC0","at-shorthand":"1D","inverted-exclamation-mark":"\xC1","inverted-question-mark":"\xC0","left-pointing-double-angle-quotation-mark":"\xAB","right-pointing-double-angle-quotation-mark":"\xBB","horizontal-ellipsis":"---","quadruple-pusta":"--","quintuple-pusta":"=\u02C6=","section-mark":"\\","double-section-mark":"\\\\","duodecimal-lsd-mark":["\xA9","\xA8","\xA8","\xA8"],"equal-sign":"\xAC","left-curl-below":["\x91","\x92","\x93","\x94"]},G={...q,"double-right-curl":["\u305E","\u3059","\u3048","\u304E"],"double-acute":["\u3024","\u3052","\u3046","\u3056"],"double-left-curl":["\u3026","\u3055","\u304A","\u304D"],"left-pointing-double-angle-quotation-mark":"\xAB","right-pointing-double-angle-quotation-mark":"\xBB","reversed-triple-dot-above":["\xAA","\xAF","\u0109","\xB5"],"acute-below":"\u2039","double-acute-below":"\u5030"};function te(e){return e==="TengwarTelcontar"?"unicode":e==="TengwarAnnatarItalic"?"unicode-artano":/^(FreeMono|TengwarFormal|Constructium|AlcarinTengwar)/.test(e)?"unicode-lowercase":/^(TengwarAnnatar|TengwarAnnatarBold|Eldamar|Parmaite)$/.test(e)?"dansmith-alt":"dansmith"}function H(e,n){let t=te(n??"TengwarTelcontar"),a=[];for(let r of e.split(`
`)){for(let i of r.split(/\s/))if(i.length>0){let o=ne(i,t);n==="TengwarTelcontar"&&(o.endsWith("\uE02E\uE04A")||o.endsWith("\uE02C\uE04A"))&&(o+="\u2009"),a.push(o)}else a.push("");a.push(`
`)}return a.join("\xA0").trim()}function Y(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&#39;"),e}function ne(e,n){let t="",a,r=[],i="",o="";for(;e.length>0;)[a,o,e]=p(e),a?c(a)?r.unshift(a):(t+=N(i,r,n),o&&(n==="unicode-lowercase"||n==="unicode")&&(t+=o),i=a,r=[]):(t+=N(i,r,n),o&&n.startsWith("unicode")&&(t+=o),i="",r=[]);return t+N(i,r,n)}function N(e,n,t){let a={"unicode-lowercase":x,unicode:D,"unicode-artano":W,"dansmith-alt":G}[t]??q,r="",i="";O(n)>0&&(e==="silme"?e="silme-nuquerna":e==="esse"?e="esse-nuquerna":e==="SILME"?e="SILME-NUQUERNA":e==="ESSE"&&(e="ESSE-NUQUERNA")),e.length===0&&n.length>0&&(e="telco");let o=e.toLowerCase();for(let l of n)if(g[o]==="diacritic-hook")i=a[l];else if(t==="unicode-lowercase"||t==="unicode")r+=a[l]??"";else{let s=a[l]??"";if(typeof s=="string")r+=s.trim();else if(s.length===2){let u=g[o]??"wide-tengwa";r+=s[u==="wide-tengwa"||u==="hook"?0:1]}else s.length===4&&(o==="silme-nuquerna"&&l==="dot-below"||o==="anna"&&l==="left-curl"?r+=s[3]:o==="hwesta"&&l==="right-curl"?r+=s[0]:r+=s[I[g[o]]??0])}return(a[e]??a[o]??"")+r+i}async function ae(e,n,t){let a=[];e.replace(n,(i,...o)=>{let l=t(i,...o);return a.push(l),""});let r=await Promise.all(a);return e.replace(n,()=>r.shift()??"")}async function Ve(e,n="TengwarTelcontar"){return e=e.replace(/{lang:([^}\]]*)}/g,'<span class="language">$1</span>'),ae(e,/{{(?:([a-z\-\/]+):)?([\s\S]*?)}}/g,async function(t,a,r){let i="",o=r.split("|"),l=o[0],s=a?.split("/")??[],u="english",d=n;s.length>0&&(u=s[0]),u||(u="english"),s.length>1&&(d=s[1]);let Q=await m(l,await A(u));return i=Y(H(Q,d).replace(/\$/g,"&#36;")),(o[1]??"$1").replace("$1",`<span class="${d}">${i}</span>`).replace("$0",l)})}export{Ve as applyHandlebarTemplate};
//# sourceMappingURL=tecendil.mjs.map
export { m as transcribe, A as loadMode, H as toFont };
